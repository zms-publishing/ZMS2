<?xml version="1.0" encoding="utf-8"?>
<list>
<item type="dictionary"><dictionary>
<item key="data"><![CDATA[<dtml-if "REQUEST.get('src_id','')==''">
 <dtml-call "REQUEST.set('src',this())">
 <dtml-with "getParentNode()">
  <dtml-call "REQUEST.set('dst',manage_addZMSDocument({},REQUEST))">
  <dtml-return "RESPONSE.redirect(url_append_params('%s/manage_ZMSFolder2ZMSDocument'%absolute_url(),{'lang':lang,'src_id':src.id,'dst_id':dst.id}))">
 </dtml-with>
<dtml-else>
 <dtml-in "objectValues(dGlobalAttrs.keys())">
  <dtml-call "writeBlock('[Folder2Document]: %s.%s'%(id,meta_id))">
 </dtml-in>
 <dtml-call "writeBlock('[Folder2Document]: Rename %s to %s'%(src_id,src_id+'00000'))">
 <dtml-call "manage_renameObject(id=src_id,new_id=src_id+'00000')">
 <dtml-call "REQUEST.set('src',_.getattr(this(),src_id+'00000'))">
 <dtml-call "writeBlock('[Folder2Document]: Rename %s to %s'%(dst_id,src_id))">
 <dtml-call "manage_renameObject(id=dst_id,new_id=src_id)">
 <dtml-call "REQUEST.set('dst',_.getattr(this(),src_id))">
 <dtml-comment> ### Move sub-objects from src to dst ### </dtml-comment>.
 <dtml-call "REQUEST.set('cb_copy_data',src.manage_cutObjects(src.objectIds()))">
 <dtml-call "dst.manage_pasteObjects( cb_copy_data)">
 <dtml-comment> ### Copy attributes from src to dst ### </dtml-comment>.
 <dtml-let values="{}">
  <dtml-in "['sort_id','version_work_id','version_live_id']">
   <dtml-let key=sequence-item>
    <dtml-if "key.startswith('version_')">
     <dtml-let ob_id="operator_getattr(dst,key,_.None)">
      <dtml-if "ob_id in dst.objectIds()">
       <dtml-call "dst.manage_delObjects(ids=[ob_id])">
      </dtml-if>
     </dtml-let>
    </dtml-if>
    <dtml-call "operator_setattr(dst,key,operator_getattr(src,key,_.None))">
   </dtml-let>
  </dtml-in>
 </dtml-let>
 <dtml-comment> ### Delete src ### </dtml-comment>.
 <dtml-call "manage_delObjects(ids=[src.id])">
 <dtml-return "RESPONSE.redirect(url_append_params('%s/manage_main'%absolute_url(),{'lang':lang,'manage_tabs_message':'Changed into document.'}))">
</dtml-if>]]></item>
<item key="description"></item>
<item key="exec" type="int">0</item>
<item key="id"><![CDATA[manage_ZMSFolder2ZMSDocument]]></item>
<item key="meta_type"><![CDATA[DTML Method]]></item>
<item key="meta_types" type="list"><list>
<item><![CDATA[ZMSFolder]]></item>
</list>
</item>
<item key="name"><![CDATA[Change into document!]]></item>
<item key="roles" type="list"><list>
<item><![CDATA[ZMSAdministrator]]></item>
</list>
</item>
</dictionary>
</item>
<item type="dictionary"><dictionary>
<item key="data"><![CDATA[<dtml-if "REQUEST.get('src_id','')==''">
 <dtml-call "REQUEST.set('src',this())">
 <dtml-with "getParentNode()">
  <dtml-call "REQUEST.set('dst',manage_addZMSFolder({},REQUEST))">
  <dtml-return "RESPONSE.redirect(url_append_params('%s/manage_ZMSDocument2ZMSFolder'%absolute_url(),{'lang':lang,'src_id':src.id,'dst_id':dst.id}))">
 </dtml-with>
<dtml-else>
 <dtml-in "objectValues(dGlobalAttrs.keys())">
  <dtml-call "writeBlock('[Folder2Document]: %s.%s'%(id,meta_id))">
 </dtml-in>
 <dtml-call "writeBlock('[Folder2Document]: Rename %s to %s'%(src_id,src_id+'00000'))">
 <dtml-call "manage_renameObject(id=src_id,new_id=src_id+'00000')">
 <dtml-call "REQUEST.set('src',_.getattr(this(),src_id+'00000'))">
 <dtml-call "writeBlock('[Folder2Document]: Rename %s to %s'%(dst_id,src_id))">
 <dtml-call "manage_renameObject(id=dst_id,new_id=src_id)">
 <dtml-call "REQUEST.set('dst',_.getattr(this(),src_id))">
 <dtml-comment> ### Move sub-objects from src to dst ### </dtml-comment>.
 <dtml-call "REQUEST.set('cb_copy_data',src.manage_cutObjects(src.objectIds()))">
 <dtml-call "dst.manage_pasteObjects( cb_copy_data)">
 <dtml-comment> ### Copy attributes from src to dst ### </dtml-comment>
 <dtml-let values="{}">
  <dtml-in "['sort_id','version_work_id','version_live_id']">
   <dtml-let key=sequence-item>
    <dtml-if "key.startswith('version_')">
     <dtml-let ob_id="operator_getattr(dst,key,_.None)">
      <dtml-if "ob_id in dst.objectIds()">
       <dtml-call "dst.manage_delObjects(ids=[ob_id])">
      </dtml-if>
     </dtml-let>
    </dtml-if>
    <dtml-call "operator_setattr(dst,key,operator_getattr(src,key,_.None))">
   </dtml-let>
  </dtml-in>
 </dtml-let>
 <dtml-comment> ### Delete src ### </dtml-comment>.
 <dtml-call "manage_delObjects(ids=[src.id])">
 <dtml-return "RESPONSE.redirect(url_append_params('%s/manage_main'%absolute_url(),{'lang':lang,'manage_tabs_message':'Changed into document.'}))">
</dtml-if>]]></item>
<item key="description"></item>
<item key="exec" type="int">0</item>
<item key="id"><![CDATA[manage_ZMSDocument2ZMSFolder]]></item>
<item key="meta_type"><![CDATA[DTML Method]]></item>
<item key="meta_types" type="list"><list>
<item><![CDATA[ZMSDocument]]></item>
</list>
</item>
<item key="name"><![CDATA[Change into folder!]]></item>
<item key="roles" type="list"><list>
<item><![CDATA[ZMSAdministrator]]></item>
</list>
</item>
</dictionary>
</item>
</list>

